"use strict";var WPFormsBuilderConversationalForms=window.WPFormsBuilderConversationalForms||function(o,n,t){var i={toggleSettingsCheckbox:t("#wpforms-panel-field-settings-conversational_forms_enable"),previewFormBtn:t("#wpforms-conversational-forms-preview-conversational-form"),slug:{textField:t("#wpforms-panel-field-settings-conversational_forms_page_slug"),editBtn:t(".wpforms-conversational-forms-page-slug-edit"),viewBtn:t(".wpforms-conversational-forms-page-slug-view"),cancelBtn:t(".wpforms-conversational-forms-page-slug-cancel")},logo:{previewContainer:t(".wpforms-conversational-forms-custom-logo-container"),textField:t("#wpforms-panel-field-settings-conversational_forms_custom_logo"),addBtn:t(".wpforms-conversational-forms-custom-logo-upload"),deleleBtn:t(".wpforms-conversational-forms-custom-logo-delete")}},r={init:function(){t(o).ready(r.ready)},debounce:function(t,i,r){var l;return function(){var e=this,o=arguments,n=r&&!l;clearTimeout(l),l=setTimeout(function(){l=null,r||t.apply(e,o)},i),n&&t.apply(e,o)}},ready:function(){r.conditionals(),r.events(),r.actions(),t("#wpforms-panel-field-settings-conversational_forms_color_scheme-wrap .minicolors-panel").append('<input type="text" id="wpforms-panel-field-settings-conversational_forms_color-input" class="minicolors-input-inner">'),o.getElementById("wpforms-panel-field-settings-conversational_forms_color-input").addEventListener("input",r.debounce(function(e){t("#wpforms-panel-field-settings-conversational_forms_color_scheme-7").minicolors("value",e.target.value)},750))},conditionals:function(){void 0!==t.fn.conditions&&i.toggleSettingsCheckbox.conditions({conditions:{element:"#wpforms-panel-field-settings-conversational_forms_enable",type:"checked",operator:"is"},actions:{if:{element:"#wpforms-conversational-forms-content-block,#wpforms-conversational-forms-preview-conversational-form",action:"show"},else:{element:"#wpforms-conversational-forms-content-block,#wpforms-conversational-forms-preview-conversational-form",action:"hide"}},effect:"appear"})},events:function(){r.generalEvents(),r.colorPickerEvents(),r.customLogoEvents(),r.formSlugEvents()},actions:function(){r.prefillPageTitle()},generalEvents:function(){i.toggleSettingsCheckbox.click(function(e){r.toggleSettingsPanel(e)})},colorPickerEvents:function(){t("#wpforms-panel-field-settings-conversational_forms_color_scheme-7").minicolors({show:function(){t(this).prop("checked",!0)},change:function(e){o.getElementById("wpforms-panel-field-settings-conversational_forms_color-input").value=e}})},customLogoEvents:function(){i.logo.addBtn.click(function(e){e.preventDefault(),r.openMediaFrame()}),i.logo.deleleBtn.click(function(e){e.preventDefault(),r.deleteCustomLogo()})},formSlugEvents:function(){i.previewFormBtn.click(function(e){r.previewForm(e)}),i.slug.viewBtn.click(function(e){r.previewForm(e)}),t("#wpforms-builder").on("wpformsSaved",function(e,o){r.updateFormSlugUI(o)})},toggleSettingsPanel:function(e){i.toggleSettingsCheckbox.is(":checked")&&t("#wpforms-panel-field-settings-form_pages_enable").is(":checked")&&(e.preventDefault(),t.confirm({title:!1,content:wpforms_admin_builder_conversational_forms.i18n.enable_prevent_modal,closeIcon:!1,icon:"fa fa-exclamation-circle",type:"orange",buttons:{cancel:{text:wpforms_admin_builder_conversational_forms.i18n.enable_prevent_modal_ok}}}))},previewForm:function(e){if(WPFormsBuilder.formIsSaved())n.open(e.target.href,"_blank");else{var o=n.open("","_blank");e.preventDefault(),WPFormsBuilder.formSave().done(function(){o.location=e.target.href})}},initMediaFrame:function(){var e,o={title:wpforms_admin_builder_conversational_forms.i18n.logo_selection_frame_title,button:{text:wpforms_admin_builder_conversational_forms.i18n.logo_selection_frame_button_text},library:{type:"image"},multiple:!1};return(e=wp.media(o)).on("select",function(){r.selectCustomLogo(e)}),e},openMediaFrame:function(){(void 0===wp.media.frame?r.initMediaFrame():wp.media.frame).open()},selectCustomLogo:function(e){var o=e.state().get("selection").first().toJSON(),n=o.url;void 0!==o.sizes.medium&&(n=o.sizes.medium.url),i.logo.deleleBtn.find("img").remove(),i.logo.deleleBtn.append('<img src="'+n+'" alt="'+wpforms_admin_builder_conversational_forms.i18n.logo_preview_alt+'"/>'),i.logo.previewContainer.show(),i.logo.textField.val(o.id),i.logo.deleleBtn.show()},deleteCustomLogo:function(){i.logo.previewContainer.find("img").remove(),i.logo.addBtn.show(),i.logo.previewContainer.hide(),i.logo.textField.val("")},updateFormSlugUI:function(e){void 0!==e.conversational_forms&&(i.slug.textField.val(e.conversational_forms.slug),i.slug.viewBtn.prop("href",e.conversational_forms.url),i.previewFormBtn.prop("href",e.conversational_forms.url))},prefillPageTitle:function(){var e;wpf.getQueryString("newform")&&((e=t("#wpforms-panel-field-settings-conversational_forms_title")).val()||e.val(t("#wpforms-panel-field-settings-form_title").val()))}};return r}(document,window,jQuery);WPFormsBuilderConversationalForms.init();